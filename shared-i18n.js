const sharedTranslations = {
    en: {
        'search': 'Search',
        'search-placeholder': 'Search heritage sites...',
        'search-world-heritage': 'Search world heritage sites...',
        'discovery': 'Discovery',
        'favorites': 'Favorites',
        'profile': 'Profile',
        'cultural': 'Cultural',
        'natural': 'Natural',
        'mixed': 'Mixed',
        'sort': 'Sort',
        'filter': 'Filter',
        'all-types': 'All Types',
        
        'world-heritage': 'World Heritage',
        'discover-unesco': 'Discover UNESCO Sites',
        'explore-by-type': 'Explore by Type',
        'nearby-sites': 'Nearby Sites',
        'sites-count-natural': '218 sites',
        'sites-count-cultural': '897 sites',
        'sites-count-mixed': '39 sites',
        
        'machu-picchu': 'Machu Picchu',
        'peru-1983': 'Peru • Inscribed 1983',
        'machu-picchu-desc': 'An extraordinary example of landscape architecture that harmonizes with nature.',
        'cusco-region': 'Cusco Region',
        
        'great-wall': 'Great Wall of China',
        'china-1987': 'China • Inscribed 1987',
        'great-wall-desc': 'A magnificent architectural feat spanning thousands of kilometers.',
        'multiple-provinces': 'Multiple Provinces',
        
        'great-barrier-reef': 'Great Barrier Reef',
        'australia-1981': 'Australia • Natural • 1981',
        
        'great-mosque': 'Great Mosque of Djenné',
        'mali-1988': 'Mali • Cultural • 1988',
        
        'great-zimbabwe': 'Great Zimbabwe',
        'zimbabwe-1986': 'Zimbabwe • Cultural • 1986',
        
        'found-results': 'Found 12 results for "Great"',
        
        'browse-categories': 'Browse Categories',
        'cultural-heritage': 'Cultural Heritage',
        'cultural-desc': 'Human-made wonders and traditions',
        'natural-heritage': 'Natural Heritage', 
        'natural-desc': 'Outstanding natural phenomena',
        'mixed-heritage': 'Mixed Heritage',
        'mixed-desc': 'Cultural and natural significance',
        
        'my-profile': 'My Profile',
        'sites-visited': 'Sites Visited',
        'achievements': 'Achievements',
        'settings': 'Settings',
        'language-region': 'Language & Region',
        'notifications': 'Notifications',
        'privacy': 'Privacy',
        'about': 'About',
        
        'overview': 'Overview',
        'location': 'Location',
        'history': 'History',
        'visit-info': 'Visit Info',
        'add-to-favorites': 'Add to Favorites',
        'share': 'Share',
        'plan-visit': 'Plan Visit',
        
        'my-favorites': 'My Favorites',
        'visited': 'Visited',
        'want-to-visit': 'Want to Visit',
        'clear-all': 'Clear All',
        'total-saved': 'Total Saved',
        
        'peru-cultural': 'Peru • Cultural Heritage',
        'cultural-sites': 'Cultural Sites',
        'cultural-sites-count': '897 heritage sites worldwide',
        
        'current-lang': 'EN',
        'main-title': 'World Heritage App',
        'main-subtitle': 'Elegant minimalist design for UNESCO World Heritage exploration',
        'feature-responsive': 'Responsive Design',
        'feature-dark': 'Dark Mode Support',
        'feature-i18n': 'Internationalization',
        'page-discovery-title': 'Discovery Home',
        'page-discovery-desc': 'Featured sites and quick categories',
        'page-search-title': 'Search & Filter',
        'page-search-desc': 'Advanced search with smart filters',
        'page-favorites-title': 'My Favorites',
        'page-favorites-desc': 'Personal collection and visit tracking',
        'page-profile-title': 'User Profile',
        'page-profile-desc': 'Stats, achievements and settings',
        'page-detail-title': 'Site Details',
        'page-detail-desc': 'Comprehensive heritage site information',
        'page-categories-title': 'Category Browse',
        'page-categories-desc': 'Explore by cultural, natural, mixed',
        'design-features-title': 'Design Features',
        'feature-elegant-title': 'Elegant Minimalism',
        'feature-elegant-desc': 'Clean layouts with perfect balance of whitespace and content',
        'feature-micro-title': 'Micro-interactions',
        'feature-micro-desc': 'Delicate animations and hover effects for enhanced UX',
        'feature-global-title': 'Global Ready',
        'feature-global-desc': 'Multi-language support with cultural sensitivity',
        'footer-text': 'World Heritage App UI Design • Built with Modern Web Technologies',
        'footer-copyright': '© 2024 Heritage Explorer Design System'
    },
    zh: {
        'search': '搜索',
        'search-placeholder': '搜索遗产地...',
        'search-world-heritage': '搜索世界遗产地...',
        'discovery': '发现',
        'favorites': '收藏',
        'profile': '资料',
        'cultural': '文化',
        'natural': '自然',
        'mixed': '混合',
        'sort': '排序',
        'filter': '筛选',
        'all-types': '所有类型',
        
        'world-heritage': '世界遗产',
        'discover-unesco': '发现联合国教科文组织遗产地',
        'explore-by-type': '按类型探索',
        'nearby-sites': '附近的目的地',
        'sites-count-natural': '218个遗产地',
        'sites-count-cultural': '897个遗产地',
        'sites-count-mixed': '39个遗产地',
        
        'machu-picchu': '马丘比丘',
        'peru-1983': '秘鲁 • 1983年列入',
        'machu-picchu-desc': '与自然和谐统一的非凡景观建筑典范。',
        'cusco-region': '库斯科地区',
        
        'great-wall': '中国长城',
        'china-1987': '中国 • 1987年列入',
        'great-wall-desc': '跨越数千公里的宏伟建筑奇迹。',
        'multiple-provinces': '多个省份',
        
        'great-barrier-reef': '大堡礁',
        'australia-1981': '澳大利亚 • 自然 • 1981年',
        
        'great-mosque': '杰内大清真寺',
        'mali-1988': '马里 • 文化 • 1988年',
        
        'great-zimbabwe': '大津巴布韦',
        'zimbabwe-1986': '津巴布韦 • 文化 • 1986年',
        
        'found-results': '为"Great"找到12个结果',
        
        'browse-categories': '浏览分类',
        'cultural-heritage': '文化遗产',
        'cultural-desc': '人类创造的奇迹和传统',
        'natural-heritage': '自然遗产',
        'natural-desc': '杰出的自然现象',
        'mixed-heritage': '混合遗产',
        'mixed-desc': '文化和自然意义',
        
        'my-profile': '我的资料',
        'sites-visited': '已访问遗产地',
        'achievements': '成就',
        'settings': '设置',
        'language-region': '语言和地区',
        'notifications': '通知',
        'privacy': '隐私',
        'about': '关于',
        
        'overview': '概述',
        'location': '位置',
        'history': '历史',
        'visit-info': '参观信息',
        'add-to-favorites': '添加到收藏',
        'share': '分享',
        'plan-visit': '计划参观',
        
        'my-favorites': '我的收藏',
        'visited': '已访问',
        'want-to-visit': '想要访问',
        'clear-all': '清除全部',
        'total-saved': '总收藏',
        
        'peru-cultural': '秘鲁 • 文化遗产',
        'cultural-sites': '文化遗产地',
        'cultural-sites-count': '全球897个遗产地',
        
        'current-lang': '中文',
        'main-title': '世界遗产应用',
        'main-subtitle': '联合国教科文组织世界遗产探索的优雅极简设计',
        'feature-responsive': '响应式设计',
        'feature-dark': '深色模式支持',
        'feature-i18n': '国际化',
        'page-discovery-title': '发现首页',
        'page-discovery-desc': '精选遗产地和快速分类',
        'page-search-title': '搜索筛选',
        'page-search-desc': '智能过滤器的高级搜索',
        'page-favorites-title': '我的收藏',
        'page-favorites-desc': '个人收藏和访问记录',
        'page-profile-title': '用户资料',
        'page-profile-desc': '统计、成就和设置',
        'page-detail-title': '遗产详情',
        'page-detail-desc': '全面的遗产地信息',
        'page-categories-title': '分类浏览',
        'page-categories-desc': '按文化、自然、混合类型探索',
        'design-features-title': '设计特色',
        'feature-elegant-title': '优雅极简',
        'feature-elegant-desc': '完美平衡空白和内容的简洁布局',
        'feature-micro-title': '微交互',
        'feature-micro-desc': '精细的动画和悬停效果增强用户体验',
        'feature-global-title': '全球化',
        'feature-global-desc': '具有文化敏感性的多语言支持',
        'footer-text': '世界遗产应用UI设计 • 采用现代网络技术构建',
        'footer-copyright': '© 2024 遗产探索者设计系统'
    }
};

class SharedI18n {
    constructor() {
        this.currentLang = localStorage.getItem('preferred-language') || 'en';
        this.isDarkMode = localStorage.getItem('dark-mode') === 'true' || false;
        this.init();
    }
    
    init() {
        window.addEventListener('message', (event) => {
            if (event.data.type === 'LANGUAGE_CHANGE') {
                this.currentLang = event.data.language;
                this.updateLanguage();
            } else if (event.data.type === 'DARK_MODE_CHANGE') {
                this.isDarkMode = event.data.isDarkMode;
                this.updateDarkMode();
            }
        });
        
        this.updateLanguage();
        this.updateDarkMode();
    }
    
    updateLanguage() {
        const elementsI18n = document.querySelectorAll('[data-i18n]');
        elementsI18n.forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (sharedTranslations[this.currentLang] && sharedTranslations[this.currentLang][key]) {
                if (element.tagName === 'INPUT' && element.placeholder !== undefined) {
                    element.placeholder = sharedTranslations[this.currentLang][key];
                } else {
                    element.textContent = sharedTranslations[this.currentLang][key];
                }
            }
        });
        
        const elementsKey = document.querySelectorAll('[data-key]');
        elementsKey.forEach(element => {
            const key = element.getAttribute('data-key');
            if (sharedTranslations[this.currentLang] && sharedTranslations[this.currentLang][key]) {
                element.innerHTML = sharedTranslations[this.currentLang][key];
            }
        });
        
        document.documentElement.lang = this.currentLang === 'zh' ? 'zh-CN' : 'en';
        
        if (document.title.includes('World Heritage App') || document.title.includes('世界遗产应用')) {
            document.title = this.currentLang === 'zh' ? 
                '世界遗产应用 - UI设计展示' : 
                'World Heritage App - UI Design Showcase';
        }
    }
    
    updateDarkMode() {
        const html = document.documentElement;
        
        if (this.isDarkMode) {
            html.classList.add('dark');
        } else {
            html.classList.remove('dark');
        }
        
        localStorage.setItem('dark-mode', this.isDarkMode);
    }
    
    getText(key) {
        return sharedTranslations[this.currentLang] && sharedTranslations[this.currentLang][key] 
            ? sharedTranslations[this.currentLang][key] 
            : key;
    }
}

document.addEventListener('DOMContentLoaded', () => {
    window.sharedI18n = new SharedI18n();
}); 